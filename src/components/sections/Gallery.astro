---
import { Image } from 'astro:assets';
import Section from '../common/SectionLayout.astro';
import SectionTitle from '../common/SectionTitle.astro';
import SectionDesc from '../common/SectionDesc.astro';
import SectionLink from '../common/SectionLink.astro';

const gallery = [
    {
        id: '1',
        title: 'Kurosaki Ichigo',
        date: '09 Mar 2023',
        tool: 'Figma',
    },
    {
        id: '2',
        title: 'Eren Yeager',
        date: '07 Apr 2023',
        tool: 'Figma',
    },
    {
        id: '3',
        title: 'Gwen Stacy',
        date: '11 Jun 2023',
        tool: 'Figma',
    },
    {
        id: '4',
        title: 'Miles Morales',
        date: '13 Jun 2023',
        tool: 'Figma',
    },
    {
        id: '5',
        title: 'Ghost',
        date: '29 Jun 2023',
        tool: 'Figma',
    },
    {
        id: '6',
        title: 'Hirako Shinji',
        date: '01 Aug 2023',
        tool: 'Alight Motion',
    },
    {
        id: '7',
        title: 'Shinobu Kocho',
        date: '02 Aug 2023',
        tool: 'Alight Motion',
    },
    {
        id: '8',
        title: 'Yamamoto Genryuusai',
        date: '03 Aug 2023',
        tool: 'Alight Motion',
    },
];

function myF() {
    console.log('clicked');
}
---

<Section>
    <div class="flex flex-col items-center justify-center py-4 md:py-14">
        <SectionTitle content="Gallery" />
        <SectionDesc content="A collection of my designs created using Figma and Alight Motion" />
        <div class="w-full px-6 md:px-8 lg:px-0">
            <div
                class="flex items-center md:grid md:grid-cols-3 lg:grid-cols-4 md:place-items-center md:overflow-visible overflow-x-auto whitespace-nowrap space-x-4 md:space-x-0 gap-4"
            >
                {
                    gallery.map(({ id, title, date, tool }) => (
                        <div class="relative w-60 md:w-full flex-shrink-0 md:flex-shrink rounded-md overflow-hidden group">
                            <Image
                                id={id}
                                src={`/images/gallery/${id}.webp`}
                                alt={title}
                                width={240}
                                height={240}
                                loading="lazy"
                                decoding="async"
                                format="webp"
                                draggable="false"
                                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
                            />
                            <div class="absolute inset-0 p-4 opacity-0 group-hover:opacity-100 backdrop-blur-md bg-black/60 transition-opacity duration-300 rounded-md">
                                <div class="flex flex-col justify-between h-full">
                                    <div class="flex items-center justify-between">
                                        <div class="-space-y-0.5">
                                            <h4 class="text-gradient text-sm">{title}</h4>
                                            <p class="text-gradient-secondary text-[0.65rem]">{date}</p>
                                        </div>
                                        <Image
                                            src={`/icons/${tool.replace(' ', '').toLowerCase()}.svg`}
                                            alt={tool}
                                            width={24}
                                            height={24}
                                            loading="lazy"
                                            decoding="async"
                                            format="svg"
                                            draggable="false"
                                            class="w-5 h-5 select-none"
                                        />
                                    </div>
                                    <div class="flex items-end justify-between">
                                        <div class="w-full flex items-center justify-between">
                                            <a
                                                href={`/images/gallery/${id}.webp`}
                                                download={`${id}.webp`}
                                                class="text-gradient text-sm hover:-translate-y-1 transition-transform duration-300"
                                            >
                                                Download
                                            </a>
                                            <button
                                                id="modal-btn"
                                                design-id={id}
                                                design-title={title}
                                                class="text-gradient text-sm hover:-translate-y-1 transition-transform duration-300"
                                            >
                                                Expand
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>
        </div>
        <SectionLink link="/gallery" content="View all designs" />
    </div>
    <script>
        document.querySelectorAll('#modal-btn').forEach((modal) => {
            modal.addEventListener('click', (e) => {
                const target = e.target as HTMLElement;
                const targetSrc = target.getAttribute('design-id');
                const targetTitle = target.getAttribute('design-title');

                if (targetSrc && targetTitle) {
                    const modalImage = document.getElementById('modal-image') as HTMLImageElement;
                    modalImage.src = `/images/gallery/${targetSrc}.webp`;
                    modalImage.alt = targetTitle;
                }

                const modal = document.getElementById('modal');
                if (modal) {
                    modal.classList.replace('hidden', 'flex');
                    setTimeout(() => {
                        modal.classList.remove('opacity-0');
                        modal.classList.add('opacity-100');
                    }, 100);
                }
            });
        });

        const closeModalBtn = document.getElementById('modal-close');
        if (closeModalBtn) {
            closeModalBtn.addEventListener('click', () => {
                const modal = document.getElementById('modal');
                if (modal) {
                    modal.classList.remove('opacity-100');
                    modal.classList.add('opacity-0');
                    setTimeout(() => {
                        modal.classList.replace('flex', 'hidden');
                    }, 150);
                }
            });
        }
    </script>
</Section>
